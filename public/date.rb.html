<!DOCTYPE html>
<html lang="en-GB">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <link rel="alternate" type="text/markdown" href="date.rb.md">
    <style>
      body {
        max-width: 38rem;
        margin: auto;
        padding: 1rem;
        font-family: system-ui;
        color: black;
        background-color: white;
      }
      p {line-height: 1.4;}
      code {
      color:lightsteelblue;
      }
      code pre {word-wrap: break-word;}
      code:hover {color:black;}
      footer {
      margin:0 auto;
      color:gray;
      display:table;
      }
      footer big {
      color:crimson;
      font-weight:bold;
      font-size:2rem;}
      
      @media (prefers-color-scheme: dark) {
body {color:white;background-color:black;}
}
    </style>
    <title>./lib/monkey_patching/date.rb</title>
  </head>
  <body><h1>A monkey patched Ruby date class to handle UK Parliament specific day types.</h1>
<code title='Line 4, ./lib/monkey_patching/date.rb'><pre><a name='4'>4</a> class Date
</pre></code><h2>A set of methods to work out the type of a given day.</h2>
<h3>We want to check if this is a praying sitting day in the Commons.</h3>
<p>We use a naive definition of a sitting day: this includes a calendar day when the Commons sits, together with following calendar days if the Commons sat through the night.</p>
<p>For example: if the Commons sat on a Tuesday and continued to sit overnight into Wednesday, both Tuesday and Wednesday would count as praying sitting days. </p>
<p>If the Tuesday sitting lasted long enough to overlap the starting time of the Wednesday sitting, the Tuesday would be a parliamentary sitting day, but the Wednesday would not.</p>
<code title='Line 16, ./lib/monkey_patching/date.rb'><pre><a name='16'>16</a>   def is_commons_praying_sitting_day?
</pre></code><code title='Line 17, ./lib/monkey_patching/date.rb'><pre><a name='17'>17</a>     SittingDay.all.where( 'start_date <= ?',  self ).where( 'end_date >= ?',  self ).where( house_id: 1 ).first
</pre></code><code title='Line 18, ./lib/monkey_patching/date.rb'><pre><a name='18'>18</a>   end
</pre></code><h3>We want to check if this is a praying sitting day in the Lords.</h3>
<p>We use a naive definition of a sitting day: this includes a calendar day when the Lords sits, together with following calendar days if the Lords sat through the night.</p>
<p>For example: if the Lords sat on a Tuesday and continued to sit overnight into Wednesday, both Tuesday and Wednesday would count as praying sitting days.</p>
<p>If the Tuesday sitting lasted long enough to overlap the starting time of the Wednesday sitting, the Tuesday would be a parliamentary sitting day, but the Wednesday would not.</p>
<code title='Line 28, ./lib/monkey_patching/date.rb'><pre><a name='28'>28</a>   def is_lords_praying_sitting_day?
</pre></code><code title='Line 29, ./lib/monkey_patching/date.rb'><pre><a name='29'>29</a>     SittingDay.all.where( 'start_date <= ?',  self ).where( 'end_date >= ?',  self ).where( house_id: 2 ).first
</pre></code><code title='Line 30, ./lib/monkey_patching/date.rb'><pre><a name='30'>30</a>   end
</pre></code><h3>We want to check if this is a parliamentary sitting day in the Commons.</h3>
<p>We use a more strict definition of a sitting day. We don’t include dates for which the Commons continued sitting from a previous day, where the preceding day’s sitting overlapped with the next day’s programmed sitting.</p>
<code title='Line 36, ./lib/monkey_patching/date.rb'><pre><a name='36'>36</a>   def is_commons_parliamentary_sitting_day?
</pre></code><code title='Line 37, ./lib/monkey_patching/date.rb'><pre><a name='37'>37</a>     SittingDay.all.where( 'start_date = ?',  self ).where( house_id: 1 ).first
</pre></code><code title='Line 38, ./lib/monkey_patching/date.rb'><pre><a name='38'>38</a>   end
</pre></code><h3>We want to check if this is a parliamentary sitting day in the Lords.</h3>
<p>We use a more strict definition of a sitting day. We don’t include dates for which the Lords continued sitting from a previous day, where the preceding day’s sitting overlapped with the next day’s programmed sitting.</p>
<code title='Line 44, ./lib/monkey_patching/date.rb'><pre><a name='44'>44</a>   def is_lords_parliamentary_sitting_day?
</pre></code><code title='Line 45, ./lib/monkey_patching/date.rb'><pre><a name='45'>45</a>     SittingDay.all.where( 'start_date = ?',  self ).where( house_id: 2 ).first
</pre></code><code title='Line 46, ./lib/monkey_patching/date.rb'><pre><a name='46'>46</a>   end
</pre></code><h3>We want to check if this is a virtual sitting day in the Commons.</h3>
<p>This is a day where all Members of the House sit ‘digitally’, rather than physically.</p>
<p>A virtual sitting may continue over more than one calendar day. We count any continuation, where the preceding day’s sitting overlapped with the next day’s programmed sitting, as also being a virtual sitting day.</p>
<p>As of the end of June 2020, the Commons has had no virtual sitting days.</p>
<code title='Line 56, ./lib/monkey_patching/date.rb'><pre><a name='56'>56</a>   def is_commons_virtual_sitting_day?
</pre></code><code title='Line 57, ./lib/monkey_patching/date.rb'><pre><a name='57'>57</a>     VirtualSittingDay.all.where( 'start_date <= ?',  self ).where( 'end_date >= ?',  self ).where( house_id: 1 ).first
</pre></code><code title='Line 58, ./lib/monkey_patching/date.rb'><pre><a name='58'>58</a>   end
</pre></code><h3>We want to check if this is a virtual sitting day in the Lords.</h3>
<p>This is a day where all Members of the House sit ‘digitally’, rather than physically.</p>
<p>A virtual sitting may continue over more than one calendar day. We count any continuation, where the preceding day’s sitting overlapped with the next day’s programmed sitting, as also being a virtual sitting day.</p>
<code title='Line 66, ./lib/monkey_patching/date.rb'><pre><a name='66'>66</a>   def is_lords_virtual_sitting_day?
</pre></code><code title='Line 67, ./lib/monkey_patching/date.rb'><pre><a name='67'>67</a>     VirtualSittingDay.all.where( 'start_date <= ?',  self ).where( 'end_date >= ?',  self ).where( house_id: 2 ).first
</pre></code><code title='Line 68, ./lib/monkey_patching/date.rb'><pre><a name='68'>68</a>   end
</pre></code><h3>We want to check if this is a praying sitting day in either House.</h3>
<code title='Line 72, ./lib/monkey_patching/date.rb'><pre><a name='72'>72</a>   def is_either_house_praying_sitting_day?
</pre></code><code title='Line 73, ./lib/monkey_patching/date.rb'><pre><a name='73'>73</a>     self.is_commons_praying_sitting_day? or self.is_lords_praying_sitting_day?
</pre></code><code title='Line 74, ./lib/monkey_patching/date.rb'><pre><a name='74'>74</a>   end
</pre></code><h3>We want to check if this is a praying sitting day in both Houses.</h3>
<code title='Line 78, ./lib/monkey_patching/date.rb'><pre><a name='78'>78</a>   def is_joint_praying_sitting_day?
</pre></code><code title='Line 79, ./lib/monkey_patching/date.rb'><pre><a name='79'>79</a>     self.is_commons_praying_sitting_day? and self.is_lords_praying_sitting_day?
</pre></code><code title='Line 80, ./lib/monkey_patching/date.rb'><pre><a name='80'>80</a>   end
</pre></code><h3>We want to check if this is a parliamentary sitting day in either House.</h3>
<code title='Line 84, ./lib/monkey_patching/date.rb'><pre><a name='84'>84</a>   def is_either_house_parliamentary_sitting_day?
</pre></code><code title='Line 85, ./lib/monkey_patching/date.rb'><pre><a name='85'>85</a>     self.is_commons_parliamentary_sitting_day? or self.is_lords_parliamentary_sitting_day?
</pre></code><code title='Line 86, ./lib/monkey_patching/date.rb'><pre><a name='86'>86</a>   end
</pre></code><h3>We want to check if this is a parliamentary sitting day in both Houses.</h3>
<code title='Line 90, ./lib/monkey_patching/date.rb'><pre><a name='90'>90</a>   def is_joint_parliamentary_sitting_day?
</pre></code><code title='Line 91, ./lib/monkey_patching/date.rb'><pre><a name='91'>91</a>     self.is_commons_parliamentary_sitting_day? and self.is_lords_parliamentary_sitting_day?
</pre></code><code title='Line 92, ./lib/monkey_patching/date.rb'><pre><a name='92'>92</a>   end
</pre></code><h3>We want to check if this is an adjournment day in either House.</h3>
<code title='Line 96, ./lib/monkey_patching/date.rb'><pre><a name='96'>96</a>   def is_adjournment_day?
</pre></code><code title='Line 97, ./lib/monkey_patching/date.rb'><pre><a name='97'>97</a>     AdjournmentDay.all.where( 'date = ?',  self ).first
</pre></code><code title='Line 98, ./lib/monkey_patching/date.rb'><pre><a name='98'>98</a>   end
</pre></code><h3>We want to check if this is an adjournment day in the Commons.</h3>
<code title='Line 102, ./lib/monkey_patching/date.rb'><pre><a name='102'>102</a>   def is_commons_adjournment_day?
</pre></code><code title='Line 103, ./lib/monkey_patching/date.rb'><pre><a name='103'>103</a>     AdjournmentDay.all.where( 'date = ?',  self ).where( house_id: 1 ).first
</pre></code><code title='Line 104, ./lib/monkey_patching/date.rb'><pre><a name='104'>104</a>   end
</pre></code><h3>We want to check if this is an adjournment day in the Lords.</h3>
<code title='Line 108, ./lib/monkey_patching/date.rb'><pre><a name='108'>108</a>   def is_lords_adjournment_day?
</pre></code><code title='Line 109, ./lib/monkey_patching/date.rb'><pre><a name='109'>109</a>     AdjournmentDay.all.where( 'date = ?',  self ).where( house_id: 2 ).first
</pre></code><code title='Line 110, ./lib/monkey_patching/date.rb'><pre><a name='110'>110</a>   end
</pre></code><h3>We want to check if Parliament is prorogued on this day.</h3>
<code title='Line 114, ./lib/monkey_patching/date.rb'><pre><a name='114'>114</a>   def is_prorogation_day?
</pre></code><code title='Line 115, ./lib/monkey_patching/date.rb'><pre><a name='115'>115</a>     ProrogationDay.all.where( 'date = ?',  self ).first
</pre></code><code title='Line 116, ./lib/monkey_patching/date.rb'><pre><a name='116'>116</a>   end
</pre></code><h3>We want to check if Parliament is dissolved on this day.</h3>
<code title='Line 120, ./lib/monkey_patching/date.rb'><pre><a name='120'>120</a>   def is_dissolution_day?
</pre></code><code title='Line 121, ./lib/monkey_patching/date.rb'><pre><a name='121'>121</a>     DissolutionDay.all.where( 'date = ?',  self ).first
</pre></code><code title='Line 122, ./lib/monkey_patching/date.rb'><pre><a name='122'>122</a>   end
</pre></code><h3>We want to check if this is a day for which we have something in the calendar.</h3>
<p>That might be a parliamentary sitting day, a praying sitting day, a virtual sitting day, an adjournment day, a day within prorogation or a day within dissolution.</p>
<code title='Line 128, ./lib/monkey_patching/date.rb'><pre><a name='128'>128</a>   def is_calendar_populated?
</pre></code><code title='Line 129, ./lib/monkey_patching/date.rb'><pre><a name='129'>129</a>     self.is_commons_praying_sitting_day? or self.is_lords_praying_sitting_day? or self.is_commons_virtual_sitting_day? or self.is_lords_virtual_sitting_day? or self.is_adjournment_day? or self.is_prorogation_day? or self.is_dissolution_day?
</pre></code><code title='Line 130, ./lib/monkey_patching/date.rb'><pre><a name='130'>130</a>   end
</pre></code><h3>We want to check if this is a day for which we do not have anything in the calendar.</h3>
<p>We use this to check if we&#39;ve &quot;run out of calendar&quot; so we don&#39;t keep cycling into future days and loop infinitely.</p>
<p>This is our event horizon.</p>
<code title='Line 138, ./lib/monkey_patching/date.rb'><pre><a name='138'>138</a>   def is_calendar_not_populated?
</pre></code><code title='Line 139, ./lib/monkey_patching/date.rb'><pre><a name='139'>139</a>     !self.is_calendar_populated?
</pre></code><code title='Line 140, ./lib/monkey_patching/date.rb'><pre><a name='140'>140</a>   end
</pre></code><h3>We want to check if this is a praying adjournment day in the Commons.</h3>
<p>During a short adjournment, adjournment days are praying days.</p>
<p>This method allows the definition of a “short” adjournment to be adjusted by passing in a maximum day count.</p>
<p>In all known cases “short” is defined as not more than four days.</p>
<p>For the purposes of calculating praying days, virtual sitting days count as adjournment days.</p>
<code title='Line 152, ./lib/monkey_patching/date.rb'><pre><a name='152'>152</a>   def is_commons_praying_adjournment_day?( maximum_day_count )
</pre></code><h3>We want to check if this is a Commons adjournnment day or a Commons virtual sitting day.</h3>
<code title='Line 156, ./lib/monkey_patching/date.rb'><pre><a name='156'>156</a>     if self.is_commons_adjournment_day? or self.is_commons_virtual_sitting_day?
</pre></code><p>Having found that this is a Commons adjournnment day or a Commons virtual sitting day, we start the adjournment day count at 1.</p>
<code title='Line 160, ./lib/monkey_patching/date.rb'><pre><a name='160'>160</a>       adjournment_day_count = 1
</pre></code><p>We want to cycle through the following days until we reach the maximum day count passed into this function.</p>
<code title='Line 164, ./lib/monkey_patching/date.rb'><pre><a name='164'>164</a>       date = self
</pre></code><code title='Line 165, ./lib/monkey_patching/date.rb'><pre><a name='165'>165</a>       for i in ( 1..maximum_day_count )
</pre></code><p>Go forward one day.</p>
<code title='Line 169, ./lib/monkey_patching/date.rb'><pre><a name='169'>169</a>         date = date.next_day
</pre></code><p>If this is a Commons adjournnment day or a Commons virtual sitting day ...</p>
<code title='Line 172, ./lib/monkey_patching/date.rb'><pre><a name='172'>172</a>         if date.is_commons_adjournment_day? or date.is_commons_virtual_sitting_day?
</pre></code><p>... add one to the adjournment day count.</p>
<code title='Line 175, ./lib/monkey_patching/date.rb'><pre><a name='175'>175</a>           adjournment_day_count +=1
</pre></code><p>If this is not a Commons adjournnment day or a Commons virtual sitting day ...</p>
<code title='Line 178, ./lib/monkey_patching/date.rb'><pre><a name='178'>178</a>         else
</pre></code><p>... stop cycling through following days.</p>
<code title='Line 181, ./lib/monkey_patching/date.rb'><pre><a name='181'>181</a>           break
</pre></code><code title='Line 182, ./lib/monkey_patching/date.rb'><pre><a name='182'>182</a>         end
</pre></code><code title='Line 183, ./lib/monkey_patching/date.rb'><pre><a name='183'>183</a>       end
</pre></code><p>We want to cycle through the preceding days until we reach the maximum day count passed into this function.</p>
<code title='Line 186, ./lib/monkey_patching/date.rb'><pre><a name='186'>186</a>       date = self
</pre></code><code title='Line 187, ./lib/monkey_patching/date.rb'><pre><a name='187'>187</a>       for i in ( 1..maximum_day_count )
</pre></code><p>Go back one day.</p>
<code title='Line 190, ./lib/monkey_patching/date.rb'><pre><a name='190'>190</a>         date = date.prev_day
</pre></code><p>If this is a Commons adjournnment day or a Commons virtual sitting day ...</p>
<code title='Line 193, ./lib/monkey_patching/date.rb'><pre><a name='193'>193</a>         if date.is_commons_adjournment_day? or date.is_commons_virtual_sitting_day?
</pre></code><p>... add one to the adjournment day count.</p>
<code title='Line 196, ./lib/monkey_patching/date.rb'><pre><a name='196'>196</a>           adjournment_day_count +=1
</pre></code><p>If this is not a Commons adjournnment day or a Commons virtual sitting day ...</p>
<code title='Line 199, ./lib/monkey_patching/date.rb'><pre><a name='199'>199</a>         else  
</pre></code><p>... stop cycling through preceding days.</p>
<code title='Line 202, ./lib/monkey_patching/date.rb'><pre><a name='202'>202</a>           break
</pre></code><code title='Line 203, ./lib/monkey_patching/date.rb'><pre><a name='203'>203</a>         end
</pre></code><code title='Line 204, ./lib/monkey_patching/date.rb'><pre><a name='204'>204</a>       end
</pre></code><p>If the total number of continuous adjournment days is more than the maximum day count ...</p>
<code title='Line 207, ./lib/monkey_patching/date.rb'><pre><a name='207'>207</a>       if adjournment_day_count > maximum_day_count
</pre></code><p>... then this day is not part of a short adjournment and so does not count as a praying day.</p>
<code title='Line 210, ./lib/monkey_patching/date.rb'><pre><a name='210'>210</a>         is_commons_short_adjournment = false
</pre></code><p>If the total number of continuous adjournment days is less than or the same as the maximum day count ...</p>
<code title='Line 213, ./lib/monkey_patching/date.rb'><pre><a name='213'>213</a>       else
</pre></code><p>... then this day is part of a short adjournment and so does count as a praying day.</p>
<code title='Line 216, ./lib/monkey_patching/date.rb'><pre><a name='216'>216</a>         is_commons_short_adjournment = true
</pre></code><code title='Line 217, ./lib/monkey_patching/date.rb'><pre><a name='217'>217</a>       end
</pre></code><p>Returns if this day is a part of a Commons short adjournment</p>
<code title='Line 220, ./lib/monkey_patching/date.rb'><pre><a name='220'>220</a>       is_commons_short_adjournment
</pre></code><code title='Line 221, ./lib/monkey_patching/date.rb'><pre><a name='221'>221</a>     end
</pre></code><code title='Line 222, ./lib/monkey_patching/date.rb'><pre><a name='222'>222</a>   end
</pre></code><p>We want to check if this is a praying day in the Commons.</p>
<p>A praying day in the Commons is either a praying sitting day in the Commons, or a praying adjournment day in the Commons.</p>
<p>We pass &#39;4&#39; as the maximum day count to the adjournment day calculation, because praying adjournment days are days within a series of not more than four adjournment days.</p>
<code title='Line 227, ./lib/monkey_patching/date.rb'><pre><a name='227'>227</a>   def is_commons_praying_day?
</pre></code><code title='Line 228, ./lib/monkey_patching/date.rb'><pre><a name='228'>228</a>     self.is_commons_praying_sitting_day? or self.is_commons_praying_adjournment_day?( 4 )
</pre></code><code title='Line 229, ./lib/monkey_patching/date.rb'><pre><a name='229'>229</a>   end
</pre></code><p>We want to check if this is a praying adjournment day in the Lords.</p>
<p>During a short adjournment, adjournment days are praying days.</p>
<p>This method allows the definition of a “short” adjournment to be adjusted by passing in a maximum day count.</p>
<p>In all known cases “short” is defined as not more than four days.</p>
<p>For the purposes of calculating praying days, virtual sitting days count as adjournment days.</p>
<code title='Line 236, ./lib/monkey_patching/date.rb'><pre><a name='236'>236</a>   def is_lords_praying_adjournment_day?( maximum_day_count )
</pre></code><p>We want to check if this is a Lords adjournnment day or a Lords virtual sitting day.</p>
<code title='Line 239, ./lib/monkey_patching/date.rb'><pre><a name='239'>239</a>     if self.is_lords_adjournment_day? or self.is_lords_virtual_sitting_day?
</pre></code><p>Having found that this is a Lords adjournnment day or a Lords virtual sitting day, we start the adjournment day count at 1.</p>
<code title='Line 242, ./lib/monkey_patching/date.rb'><pre><a name='242'>242</a>       adjournment_day_count = 1
</pre></code><p>We want to cycle through the following days until we reach the maximum day count passed into this function.</p>
<code title='Line 245, ./lib/monkey_patching/date.rb'><pre><a name='245'>245</a>       date = self
</pre></code><code title='Line 246, ./lib/monkey_patching/date.rb'><pre><a name='246'>246</a>       for i in ( 1..maximum_day_count )
</pre></code><p>Go forward one day.</p>
<code title='Line 249, ./lib/monkey_patching/date.rb'><pre><a name='249'>249</a>         date = date.next_day
</pre></code><p>If this is a Lords adjournnment day or a Lords virtual sitting day ...</p>
<code title='Line 252, ./lib/monkey_patching/date.rb'><pre><a name='252'>252</a>         if date.is_lords_adjournment_day? or date.is_lords_virtual_sitting_day?
</pre></code><p>... add one to the adjournment day count.</p>
<code title='Line 255, ./lib/monkey_patching/date.rb'><pre><a name='255'>255</a>           adjournment_day_count +=1
</pre></code><p>If this is not a Lords adjournnment day or a Lords virtual sitting day ...</p>
<code title='Line 258, ./lib/monkey_patching/date.rb'><pre><a name='258'>258</a>         else
</pre></code><p>... stop cycling through following days.</p>
<code title='Line 261, ./lib/monkey_patching/date.rb'><pre><a name='261'>261</a>           break
</pre></code><code title='Line 262, ./lib/monkey_patching/date.rb'><pre><a name='262'>262</a>         end
</pre></code><code title='Line 263, ./lib/monkey_patching/date.rb'><pre><a name='263'>263</a>       end
</pre></code><p>We want to cycle through the preceding days until we reach the maximum day count passed into this function.</p>
<code title='Line 266, ./lib/monkey_patching/date.rb'><pre><a name='266'>266</a>       date = self
</pre></code><code title='Line 267, ./lib/monkey_patching/date.rb'><pre><a name='267'>267</a>       for i in ( 1..maximum_day_count )
</pre></code><p>Go back one day.</p>
<code title='Line 270, ./lib/monkey_patching/date.rb'><pre><a name='270'>270</a>         date = date.prev_day
</pre></code><p>If this is a Lords adjournnment day or a Lords virtual sitting day ...</p>
<code title='Line 273, ./lib/monkey_patching/date.rb'><pre><a name='273'>273</a>         if date.is_lords_adjournment_day? or date.is_lords_virtual_sitting_day?
</pre></code><p>... add one to the adjournment day count.</p>
<code title='Line 276, ./lib/monkey_patching/date.rb'><pre><a name='276'>276</a>           adjournment_day_count +=1
</pre></code><p>If this is not a Lords adjournnment day or a Lords virtual sitting day ...</p>
<code title='Line 279, ./lib/monkey_patching/date.rb'><pre><a name='279'>279</a>         else  
</pre></code><p>... stop cycling through preceding days.</p>
<code title='Line 282, ./lib/monkey_patching/date.rb'><pre><a name='282'>282</a>           break
</pre></code><code title='Line 283, ./lib/monkey_patching/date.rb'><pre><a name='283'>283</a>         end
</pre></code><code title='Line 284, ./lib/monkey_patching/date.rb'><pre><a name='284'>284</a>       end
</pre></code><p>If the total number of continuous adjournment days is more than the maximum day count ...</p>
<code title='Line 287, ./lib/monkey_patching/date.rb'><pre><a name='287'>287</a>       if adjournment_day_count > maximum_day_count
</pre></code><p>... then this day is not part of a short adjournment and so does not count as a praying day.</p>
<code title='Line 290, ./lib/monkey_patching/date.rb'><pre><a name='290'>290</a>         is_lords_short_adjournment = false
</pre></code><p>If the total number of continuous adjournment days is less than or the same as the maximum day count ...</p>
<code title='Line 293, ./lib/monkey_patching/date.rb'><pre><a name='293'>293</a>       else
</pre></code><p>... then this day is part of a short adjournment and so does count as a praying day.</p>
<code title='Line 296, ./lib/monkey_patching/date.rb'><pre><a name='296'>296</a>         is_lords_short_adjournment = true
</pre></code><code title='Line 297, ./lib/monkey_patching/date.rb'><pre><a name='297'>297</a>       end
</pre></code><p>Returns if this day is a part of a Lords short adjournment</p>
<code title='Line 300, ./lib/monkey_patching/date.rb'><pre><a name='300'>300</a>       is_lords_short_adjournment
</pre></code><code title='Line 301, ./lib/monkey_patching/date.rb'><pre><a name='301'>301</a>     end
</pre></code><code title='Line 302, ./lib/monkey_patching/date.rb'><pre><a name='302'>302</a>   end
</pre></code><p>We want to check if this is a praying day in the Lords.</p>
<p>A praying day in the Lords is either a praying sitting day in the Lords, or a praying adjournment day in the Lords.</p>
<p>We pass &#39;4&#39; as the maximum day count to the adjournment day calculation, because praying adjournment days are days within a series of not more than four adjournment days.</p>
<code title='Line 307, ./lib/monkey_patching/date.rb'><pre><a name='307'>307</a>   def is_lords_praying_day?
</pre></code><code title='Line 308, ./lib/monkey_patching/date.rb'><pre><a name='308'>308</a>     self.is_lords_praying_sitting_day? or self.is_lords_praying_adjournment_day?( 4 )
</pre></code><code title='Line 309, ./lib/monkey_patching/date.rb'><pre><a name='309'>309</a>   end
</pre></code><p>We want to check if this is a praying day in either House.</p>
<code title='Line 312, ./lib/monkey_patching/date.rb'><pre><a name='312'>312</a>   def is_either_house_praying_day?
</pre></code><code title='Line 313, ./lib/monkey_patching/date.rb'><pre><a name='313'>313</a>     self.is_commons_praying_day? or self.is_lords_praying_day?
</pre></code><code title='Line 314, ./lib/monkey_patching/date.rb'><pre><a name='314'>314</a>   end
</pre></code><p>We want to check if this is a praying day in both Houses.</p>
<code title='Line 317, ./lib/monkey_patching/date.rb'><pre><a name='317'>317</a>   def is_joint_praying_day?
</pre></code><code title='Line 318, ./lib/monkey_patching/date.rb'><pre><a name='318'>318</a>     self.is_commons_praying_day? and self.is_lords_praying_day?
</pre></code><code title='Line 319, ./lib/monkey_patching/date.rb'><pre><a name='319'>319</a>   end
</pre></code><p>End of set of methods to work out the type of a given day.</p>
<p>A set of methods to find the first day of a given type.</p>
<p>We want to find the first praying day in either House.</p>
<p>This method is used when a Statutory Instrument is not laid in a praying period, that is: during an adjournment of more than four days, or during a period in which Parliament is prorogued. In such cases, the clock starts from the first praying sitting day in either House following the laying.</p>
<p>This method is used for bicameral negative SIs - and bicameral made affirmatives where the enabling legislation specifies that either House can be sitting.</p>
<code title='Line 330, ./lib/monkey_patching/date.rb'><pre><a name='330'>330</a>   def first_praying_day_in_either_house
</pre></code><p>If this is a day on which the calendar is not yet populated ...</p>
<code title='Line 333, ./lib/monkey_patching/date.rb'><pre><a name='333'>333</a>     if self.is_calendar_not_populated?
</pre></code><p>... then we cannot find a first praying day so we stop looking.</p>
<code title='Line 336, ./lib/monkey_patching/date.rb'><pre><a name='336'>336</a>       return nil
</pre></code><p>If this is a day on which the calendar is populated ...</p>
<code title='Line 339, ./lib/monkey_patching/date.rb'><pre><a name='339'>339</a>     else
</pre></code><p>... then if this is not a praying day in either House ...</p>
<code title='Line 342, ./lib/monkey_patching/date.rb'><pre><a name='342'>342</a>       unless self.is_either_house_praying_day?
</pre></code><p>... then go to the next day and check that.</p>
<code title='Line 345, ./lib/monkey_patching/date.rb'><pre><a name='345'>345</a>         self.next_day.first_praying_day_in_either_house
</pre></code><p>... then if this is a praying day in either House ...</p>
<code title='Line 348, ./lib/monkey_patching/date.rb'><pre><a name='348'>348</a>       else
</pre></code><p>... then return this day as the first praying day in either House.</p>
<code title='Line 351, ./lib/monkey_patching/date.rb'><pre><a name='351'>351</a>         self
</pre></code><code title='Line 352, ./lib/monkey_patching/date.rb'><pre><a name='352'>352</a>       end
</pre></code><code title='Line 353, ./lib/monkey_patching/date.rb'><pre><a name='353'>353</a>     end
</pre></code><code title='Line 354, ./lib/monkey_patching/date.rb'><pre><a name='354'>354</a>   end
</pre></code><p>We want to find the first praying day in both Houses.</p>
<p>This method is used when a Statutory Instrument is not laid in a praying period, that is: during an adjournment of more than four days, or during a period in which Parliament is prorogued. The clock starts from the first praying sitting day in both Houses following the laying.</p>
<p>This method is used for bicameral made affirmatives where the enabling legislation specifies that both Houses must be sitting.</p>
<code title='Line 359, ./lib/monkey_patching/date.rb'><pre><a name='359'>359</a>   def first_joint_praying_day
</pre></code><p>If this is a day on which the calendar is not yet populated ...</p>
<code title='Line 362, ./lib/monkey_patching/date.rb'><pre><a name='362'>362</a>     if self.is_calendar_not_populated?
</pre></code><p>... then we cannot find a first praying day so we stop looking.</p>
<code title='Line 365, ./lib/monkey_patching/date.rb'><pre><a name='365'>365</a>       return nil
</pre></code><p>If this is a day on which the calendar is populated ...</p>
<code title='Line 368, ./lib/monkey_patching/date.rb'><pre><a name='368'>368</a>     else
</pre></code><p>... then if this is not a praying day in both Houses ...</p>
<code title='Line 371, ./lib/monkey_patching/date.rb'><pre><a name='371'>371</a>       unless self.is_joint_praying_day?
</pre></code><p>... then go to the next day and check that.</p>
<code title='Line 374, ./lib/monkey_patching/date.rb'><pre><a name='374'>374</a>         self.next_day.first_joint_praying_day
</pre></code><p>... then if this is a praying day in both Houses ...</p>
<code title='Line 377, ./lib/monkey_patching/date.rb'><pre><a name='377'>377</a>       else
</pre></code><p>... then return this day as the first praying day in both Houses.</p>
<code title='Line 380, ./lib/monkey_patching/date.rb'><pre><a name='380'>380</a>         self
</pre></code><code title='Line 381, ./lib/monkey_patching/date.rb'><pre><a name='381'>381</a>       end
</pre></code><code title='Line 382, ./lib/monkey_patching/date.rb'><pre><a name='382'>382</a>     end
</pre></code><code title='Line 383, ./lib/monkey_patching/date.rb'><pre><a name='383'>383</a>   end
</pre></code><p>We want to find the first praying day in the Commons.</p>
<p>This method is used when a Statutory Instrument is not laid in a praying period, that is: during an adjournment of more than four days, or during a period in which Parliament is prorogued. The clock starts from the first praying sitting day in the Commons following the laying.</p>
<p>This method is used for negative or made affirmative SIs - laid in the Commons and not laid in the Lords.</p>
<code title='Line 388, ./lib/monkey_patching/date.rb'><pre><a name='388'>388</a>   def first_commons_praying_day
</pre></code><p>If this is a day on which the calendar is not yet populated ...</p>
<code title='Line 391, ./lib/monkey_patching/date.rb'><pre><a name='391'>391</a>     if self.is_calendar_not_populated?
</pre></code><p>... then we cannot find a first Commons praying day so we stop looking.</p>
<code title='Line 394, ./lib/monkey_patching/date.rb'><pre><a name='394'>394</a>       return nil
</pre></code><p>If this is a day on which the calendar is populated ...</p>
<code title='Line 397, ./lib/monkey_patching/date.rb'><pre><a name='397'>397</a>     else
</pre></code><p>... then if this is not a praying day in the Commons ...</p>
<code title='Line 400, ./lib/monkey_patching/date.rb'><pre><a name='400'>400</a>       unless self.is_commons_praying_day?
</pre></code><p>... then go to the next day and check that.</p>
<code title='Line 403, ./lib/monkey_patching/date.rb'><pre><a name='403'>403</a>         self.next_day.first_commons_praying_day
</pre></code><p>... then if this is a praying day in the Commons ...</p>
<code title='Line 406, ./lib/monkey_patching/date.rb'><pre><a name='406'>406</a>       else
</pre></code><p>... then return this day as the first praying day in the Commons.</p>
<code title='Line 409, ./lib/monkey_patching/date.rb'><pre><a name='409'>409</a>         self
</pre></code><code title='Line 410, ./lib/monkey_patching/date.rb'><pre><a name='410'>410</a>       end
</pre></code><code title='Line 411, ./lib/monkey_patching/date.rb'><pre><a name='411'>411</a>     end
</pre></code><code title='Line 412, ./lib/monkey_patching/date.rb'><pre><a name='412'>412</a>   end
</pre></code><p>We want to find the first parliamentary sitting day in both Houses.</p>
<p>This method is used when a Proposed Negative Statutory Instrument is laid.</p>
<p>Even if a PNSI is laid on a joint parliamentary sitting day, the clock does not start until the next joint parliamentary sitting day.</p>
<code title='Line 417, ./lib/monkey_patching/date.rb'><pre><a name='417'>417</a>   def first_joint_parliamentary_sitting_day
</pre></code><p>If this is a day on which the calendar is not yet populated ...</p>
<code title='Line 420, ./lib/monkey_patching/date.rb'><pre><a name='420'>420</a>     if self.is_calendar_not_populated?
</pre></code><p>... then we cannot find a first parliamentary sitting day in both Houses so we stop looking.</p>
<code title='Line 423, ./lib/monkey_patching/date.rb'><pre><a name='423'>423</a>       return nil
</pre></code><p>If this is a day on which the calendar is populated ...</p>
<code title='Line 426, ./lib/monkey_patching/date.rb'><pre><a name='426'>426</a>     else
</pre></code><p>... then if this is not a parliamentary sitting day in both Houses ...</p>
<code title='Line 429, ./lib/monkey_patching/date.rb'><pre><a name='429'>429</a>       unless self.is_joint_parliamentary_sitting_day?
</pre></code><p>... then go to the next day and check that.</p>
<code title='Line 432, ./lib/monkey_patching/date.rb'><pre><a name='432'>432</a>         self.next_day.first_joint_parliamentary_sitting_day
</pre></code><p>... then if this is a parliamentary sitting day in both Houses ...</p>
<code title='Line 435, ./lib/monkey_patching/date.rb'><pre><a name='435'>435</a>       else
</pre></code><p>... then return this day as the first parliamentary sitting day in both Houses.</p>
<code title='Line 438, ./lib/monkey_patching/date.rb'><pre><a name='438'>438</a>         self
</pre></code><code title='Line 439, ./lib/monkey_patching/date.rb'><pre><a name='439'>439</a>       end
</pre></code><code title='Line 440, ./lib/monkey_patching/date.rb'><pre><a name='440'>440</a>     end
</pre></code><code title='Line 441, ./lib/monkey_patching/date.rb'><pre><a name='441'>441</a>   end
</pre></code><p>We want to find the first parliamentary sitting day in the Commons.</p>
<p>This method is used when a motion to not ratify a treaty in either House is approved - and the Government make a statement that the treaty should nonetheless be ratified, triggering treaty scrutiny period B.</p>
<p>Treaty scrutiny period B starts on the first Commons parliamentary sitting day following the date of the Government statement.</p>
<code title='Line 446, ./lib/monkey_patching/date.rb'><pre><a name='446'>446</a>   def first_commons_parliamentary_sitting_day
</pre></code><p>If this is a day on which the calendar is not yet populated ...</p>
<code title='Line 449, ./lib/monkey_patching/date.rb'><pre><a name='449'>449</a>     if self.is_calendar_not_populated?
</pre></code><p>... then we cannot find a first parliamentary sitting day in the Commons so we stop looking.</p>
<code title='Line 452, ./lib/monkey_patching/date.rb'><pre><a name='452'>452</a>       return nil
</pre></code><p>If this is a day on which the calendar is populated ...</p>
<code title='Line 455, ./lib/monkey_patching/date.rb'><pre><a name='455'>455</a>     else
</pre></code><p>... then if this is not a parliamentary sitting day in the Commons ...</p>
<code title='Line 458, ./lib/monkey_patching/date.rb'><pre><a name='458'>458</a>       unless self.is_commons_parliamentary_sitting_day?
</pre></code><p>... then go to the next day and check that.</p>
<code title='Line 461, ./lib/monkey_patching/date.rb'><pre><a name='461'>461</a>         self.next_day.first_commons_parliamentary_sitting_day
</pre></code><p>... then if this is a parliamentary sitting day in the Commons ...</p>
<code title='Line 464, ./lib/monkey_patching/date.rb'><pre><a name='464'>464</a>       else
</pre></code><p>... then return this day as the first parliamentary sitting day in the Commons.</p>
<code title='Line 467, ./lib/monkey_patching/date.rb'><pre><a name='467'>467</a>         self
</pre></code><code title='Line 468, ./lib/monkey_patching/date.rb'><pre><a name='468'>468</a>       end
</pre></code><code title='Line 469, ./lib/monkey_patching/date.rb'><pre><a name='469'>469</a>     end
</pre></code><code title='Line 470, ./lib/monkey_patching/date.rb'><pre><a name='470'>470</a>   end
</pre></code><p>End of set of methods to find the first day of a given type.</p>
<p>Generate label for the day type in the Commons in a session.</p>
<code title='Line 484, ./lib/monkey_patching/date.rb'><pre><a name='484'>484</a>   def commons_day_type
</pre></code><code title='Line 485, ./lib/monkey_patching/date.rb'><pre><a name='485'>485</a>     if self.is_commons_parliamentary_sitting_day?
</pre></code><code title='Line 486, ./lib/monkey_patching/date.rb'><pre><a name='486'>486</a>       day_type = 'Sitting day'
</pre></code><code title='Line 487, ./lib/monkey_patching/date.rb'><pre><a name='487'>487</a>     elsif self.is_commons_virtual_sitting_day?
</pre></code><code title='Line 488, ./lib/monkey_patching/date.rb'><pre><a name='488'>488</a>       day_type = 'Virtual sitting day'
</pre></code><code title='Line 489, ./lib/monkey_patching/date.rb'><pre><a name='489'>489</a>     elsif self.is_commons_praying_sitting_day?
</pre></code><code title='Line 490, ./lib/monkey_patching/date.rb'><pre><a name='490'>490</a>       day_type = "Sitting praying day"
</pre></code><code title='Line 491, ./lib/monkey_patching/date.rb'><pre><a name='491'>491</a>     elsif self.is_commons_praying_adjournment_day?( 4 )
</pre></code><code title='Line 492, ./lib/monkey_patching/date.rb'><pre><a name='492'>492</a>       day_type = 'Praying adjournment day'
</pre></code><code title='Line 493, ./lib/monkey_patching/date.rb'><pre><a name='493'>493</a>     elsif self.is_commons_adjournment_day?
</pre></code><code title='Line 494, ./lib/monkey_patching/date.rb'><pre><a name='494'>494</a>       day_type = 'Adjournment day'
</pre></code><code title='Line 495, ./lib/monkey_patching/date.rb'><pre><a name='495'>495</a>     end
</pre></code><code title='Line 496, ./lib/monkey_patching/date.rb'><pre><a name='496'>496</a>     day_type
</pre></code><code title='Line 497, ./lib/monkey_patching/date.rb'><pre><a name='497'>497</a>   end
</pre></code><p>Generate label for the day type in the Lords in a session.</p>
<code title='Line 500, ./lib/monkey_patching/date.rb'><pre><a name='500'>500</a>   def lords_day_type
</pre></code><code title='Line 501, ./lib/monkey_patching/date.rb'><pre><a name='501'>501</a>     if self.is_lords_parliamentary_sitting_day?
</pre></code><code title='Line 502, ./lib/monkey_patching/date.rb'><pre><a name='502'>502</a>       day_type = 'Sitting day'
</pre></code><code title='Line 503, ./lib/monkey_patching/date.rb'><pre><a name='503'>503</a>     elsif self.is_lords_virtual_sitting_day?
</pre></code><code title='Line 504, ./lib/monkey_patching/date.rb'><pre><a name='504'>504</a>       day_type = 'Virtual sitting day'
</pre></code><code title='Line 505, ./lib/monkey_patching/date.rb'><pre><a name='505'>505</a>     elsif self.is_lords_praying_sitting_day?
</pre></code><code title='Line 506, ./lib/monkey_patching/date.rb'><pre><a name='506'>506</a>       day_type = "Sitting praying day"
</pre></code><code title='Line 507, ./lib/monkey_patching/date.rb'><pre><a name='507'>507</a>     elsif self.is_lords_praying_adjournment_day?( 4 )
</pre></code><code title='Line 508, ./lib/monkey_patching/date.rb'><pre><a name='508'>508</a>       day_type = 'Praying adjournment day'
</pre></code><code title='Line 509, ./lib/monkey_patching/date.rb'><pre><a name='509'>509</a>     elsif self.is_lords_adjournment_day?
</pre></code><code title='Line 510, ./lib/monkey_patching/date.rb'><pre><a name='510'>510</a>       day_type = 'Adjournment day'
</pre></code><code title='Line 511, ./lib/monkey_patching/date.rb'><pre><a name='511'>511</a>     end
</pre></code><code title='Line 512, ./lib/monkey_patching/date.rb'><pre><a name='512'>512</a>     day_type
</pre></code><code title='Line 513, ./lib/monkey_patching/date.rb'><pre><a name='513'>513</a>   end
</pre></code><p>Generate a label to say whether it&#39;s a praying day in the Commons or not.</p>
<code title='Line 516, ./lib/monkey_patching/date.rb'><pre><a name='516'>516</a>   def is_commons_praying_day_label
</pre></code><code title='Line 517, ./lib/monkey_patching/date.rb'><pre><a name='517'>517</a>     if self.is_commons_praying_day?
</pre></code><code title='Line 518, ./lib/monkey_patching/date.rb'><pre><a name='518'>518</a>       label = 'True'
</pre></code><code title='Line 519, ./lib/monkey_patching/date.rb'><pre><a name='519'>519</a>     else
</pre></code><code title='Line 520, ./lib/monkey_patching/date.rb'><pre><a name='520'>520</a>       label = 'False'
</pre></code><code title='Line 521, ./lib/monkey_patching/date.rb'><pre><a name='521'>521</a>     end
</pre></code><code title='Line 522, ./lib/monkey_patching/date.rb'><pre><a name='522'>522</a>     label
</pre></code><code title='Line 523, ./lib/monkey_patching/date.rb'><pre><a name='523'>523</a>   end
</pre></code><p>Generate a label to say whether it&#39;s a praying day in the Lords or not.</p>
<code title='Line 526, ./lib/monkey_patching/date.rb'><pre><a name='526'>526</a>   def is_lords_praying_day_label
</pre></code><code title='Line 527, ./lib/monkey_patching/date.rb'><pre><a name='527'>527</a>     if self.is_lords_praying_day?
</pre></code><code title='Line 528, ./lib/monkey_patching/date.rb'><pre><a name='528'>528</a>       label = 'True'
</pre></code><code title='Line 529, ./lib/monkey_patching/date.rb'><pre><a name='529'>529</a>     else
</pre></code><code title='Line 530, ./lib/monkey_patching/date.rb'><pre><a name='530'>530</a>       label = 'False'
</pre></code><code title='Line 531, ./lib/monkey_patching/date.rb'><pre><a name='531'>531</a>     end
</pre></code><code title='Line 532, ./lib/monkey_patching/date.rb'><pre><a name='532'>532</a>     label
</pre></code><code title='Line 533, ./lib/monkey_patching/date.rb'><pre><a name='533'>533</a>   end
</pre></code><code title='Line 534, ./lib/monkey_patching/date.rb'><pre><a name='534'>534</a> end</pre></code><footer><p><big>&times;&times;&times;</big></p></footer></body></html>